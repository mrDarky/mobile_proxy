#:kivy 2.3.0

<DeviceItem>:
    size_hint_y: None
    height: dp(80)
    padding: dp(10)
    spacing: dp(10)
    
    BoxLayout:
        orientation: 'vertical'
        spacing: dp(5)
        
        Label:
            text: root.device_name
            size_hint_y: None
            height: dp(25)
            font_size: '16sp'
            bold: True
            color: 0.2, 0.6, 1, 1
            halign: 'left'
            text_size: self.size
        
        Label:
            text: f"Serial: {root.serial}"
            size_hint_y: None
            height: dp(20)
            font_size: '12sp'
            color: 0.7, 0.7, 0.7, 1
            halign: 'left'
            text_size: self.size
        
        Label:
            text: f"Android {root.android_version}"
            size_hint_y: None
            height: dp(20)
            font_size: '12sp'
            color: 0.7, 0.7, 0.7, 1
            halign: 'left'
            text_size: self.size
    
    Button:
        text: 'Add Connection'
        size_hint_x: None
        width: dp(120)
        on_release: root.on_add_connection()

<ConnectionItem>:
    size_hint_y: None
    height: dp(100)
    padding: dp(10)
    spacing: dp(10)
    
    BoxLayout:
        orientation: 'vertical'
        spacing: dp(5)
        
        Label:
            text: f"localhost:{root.local_port} -> {root.serial}:{root.remote_port}"
            size_hint_y: None
            height: dp(25)
            font_size: '14sp'
            bold: True
            color: 1, 1, 1, 1
            halign: 'left'
            text_size: self.size
        
        Label:
            text: f"Status: {root.status}"
            size_hint_y: None
            height: dp(20)
            font_size: '12sp'
            color: (0.2, 1, 0.2, 1) if root.status == 'active' else (1, 0.5, 0, 1)
            halign: 'left'
            text_size: self.size
        
        Label:
            text: f"IP: {root.current_ip if root.current_ip else 'Unknown'}"
            size_hint_y: None
            height: dp(20)
            font_size: '12sp'
            color: 0.7, 0.7, 0.7, 1
            halign: 'left'
            text_size: self.size
    
    BoxLayout:
        orientation: 'vertical'
        size_hint_x: None
        width: dp(100)
        spacing: dp(5)
        
        Button:
            text: 'Start' if root.status == 'stopped' else 'Stop'
            size_hint_y: None
            height: dp(30)
            on_release: root.on_toggle()
        
        Button:
            text: 'Check IP'
            size_hint_y: None
            height: dp(30)
            on_release: root.on_check_ip()
        
        Button:
            text: 'Change IP'
            size_hint_y: None
            height: dp(30)
            on_release: root.on_change_ip()

<MainLayout>:
    orientation: 'vertical'
    padding: dp(10)
    spacing: dp(10)
    
    BoxLayout:
        size_hint_y: None
        height: dp(50)
        spacing: dp(10)
        
        Label:
            text: 'Mobile Proxy Manager'
            font_size: '20sp'
            bold: True
            size_hint_x: 0.6
        
        Button:
            text: 'Refresh Devices'
            size_hint_x: 0.2
            on_release: root.refresh_devices()
        
        Button:
            text: 'Refresh All'
            size_hint_x: 0.2
            on_release: root.refresh_all()
    
    BoxLayout:
        orientation: 'horizontal'
        spacing: dp(10)
        
        BoxLayout:
            orientation: 'vertical'
            size_hint_x: 0.4
            
            Label:
                text: 'Connected Devices'
                size_hint_y: None
                height: dp(40)
                font_size: '16sp'
                bold: True
            
            ScrollView:
                BoxLayout:
                    id: device_list
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(5)
        
        BoxLayout:
            orientation: 'vertical'
            size_hint_x: 0.6
            
            Label:
                text: 'Active Connections'
                size_hint_y: None
                height: dp(40)
                font_size: '16sp'
                bold: True
            
            ScrollView:
                BoxLayout:
                    id: connection_list
                    orientation: 'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(5)
